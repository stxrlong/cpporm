# cpporm
A simple c++-orm framework simplifies the operation of mysql sdk, and this code relies on the boost library and the mysql connector/c++ library. Currently only inserts and queries are supported.

## Usage
1. Create your related object and sql statement for the query in model's mysqltable.hpp (inserted sql statements generated by the framework itself).
    
    TABLE(USER,user)  <br>
    FIELD(USER,std::string,username,FieldType::STRING) <br>
    FIELD(USER,std::string,password,FieldType::STRING) <br>
    FIELD(USER,int,state,FieldType::INT32) <br>
    FIELD(USER,std::string,createTime,FieldType::STRING) <br>
    FIELD(USER,std::string,modifyTime,FieldType::STRING) <br>
    SQLSTRING(USER,one_user,"select * from user where username = ? and state = ?;") <br>
    SQLSTRING(USER,all_user,"select * from user;") <br>
    ENDTABLE
    
2. Initialize the database connection in main as shown below

    a).  std::string url = "mysql://username:password@ip:port/database_name?maxConn=2";<br>
        e.g.   "mysql://test:test@192.168.1.106:3306/test?maxConn=10"
    
    b). MysqlConnPool::instance().init(url) should return true.
    
3. Create a connection and use insert-and-select functions.

    MysqlPrep mysql;<br>
    USER user;<br>
    user.username = "zhangsan";<br>
    user.password = "123456";<br>
    user.state = 1;<br>
    user.createTime = "2020-01-22 19:10:32";<br>
    if(!mysql.insert(user)){<br>
        std::cout<< "insert user1 error." <<std::endl;<br>
    }
    
    ParamMap pm;<br>
    pm[1] = "zhangsan"; // username (std::string)<br>
    pm[2] = 1;  //state (int)

    std::pair<MysqlRet, USER> s_user = mysql.selectOne<USER>("one_user", pm);<br>
    if (s_user.first == MysqlRet::SUCCESS) {<br>
        std::cout<<"user.username:"<<s_user.second.username<<std::endl;<br>
        std::cout<<"user.password:"<<s_user.second.password<<std::endl;<br>
        std::cout<<"user.state:"<<s_user.second.state<<std::endl;<br>
        std::cout<<"user.createTime:"<<s_user.second.createTime<<std::endl;<br>
    }
    
## Reference
    [Tiny-ormhttps://github.com/david-pp/tiny-orm](https://github.com/david-pp/tiny-orm)



    
    
    
