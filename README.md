# cpporm
A simple c++-orm framework simplifies the operation of mysql sdk, and this code relies on the boost library and the mysql connector/c++ library. Currently only inserts and queries are supported.

## Usage
1. Create your related object and sql statement for the query in model's mysqltable.hpp (inserted sql statements generated by the framework itself).
    
    TABLE(USER,user)  
    FIELD(USER,std::string,username,FieldType::STRING)
    FIELD(USER,std::string,password,FieldType::STRING)
    FIELD(USER,int,state,FieldType::INT32)
    FIELD(USER,std::string,createTime,FieldType::STRING)
    FIELD(USER,std::string,modifyTime,FieldType::STRING)
    SQLSTRING(USER,one_user,"select * from user where username = ? and state = ?;")
    SQLSTRING(USER,all_user,"select * from user;")
    ENDTABLE
    
2. Initialize the database connection in main as shown below

    a).  std::string url = "mysql://username:password@ip:port/database_name?maxConn=2";
        e.g.   "mysql://test:test@192.168.1.106:3306/test?maxConn=10"
    
    b). MysqlConnPool::instance().init(url) should return true.
    
3. Create a connection and use insert-and-select functions.

    MysqlPrep mysql;
    USER user;
    user.username = "zhangsan";
    user.password = "123456";
    user.state = 1;
    user.createTime = "2020-01-22 19:10:32";
    if(!mysql.insert(user)){
        std::cout<< "insert user1 error." <<std::endl;
    }
    
    ParamMap pm;
    pm[1] = "zhangsan"; // username (std::string)
    pm[2] = 1;  //state (int)

    std::pair<MysqlRet, USER> s_user = mysql.selectOne<USER>("one_user", pm);
    if (s_user.first == MysqlRet::SUCCESS) {
        std::cout<<"user.username:"<<s_user.second.username<<std::endl;
        std::cout<<"user.password:"<<s_user.second.password<<std::endl;
        std::cout<<"user.state:"<<s_user.second.state<<std::endl;
        std::cout<<"user.createTime:"<<s_user.second.createTime<<std::endl;
    }



    
    
    
